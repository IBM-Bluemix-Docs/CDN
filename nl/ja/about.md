---

copyright:
  years: 2017, 2018
lastupdated: "2018-03-23"

---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:codeblock: .codeblock}
{:pre: .pre}
{:screen: .screen}
{:tip: .tip}
{:download: .download}

# コンテンツ配信ネットワーク (CDN) について

コンテンツ配信ネットワーク (CDN) は、全国または世界中に分散されたエッジ・サーバーの集合です。その Web コンテンツは、要求元のユーザーに最も近い地理的領域にあるエッジ・サーバーから提供されます。この技術により、エンド・ユーザーは少ない遅延時間でコンテンツを受け取ることができ、より優れた総合的な経験をカスタマーに提供することができます。

## CDN の動作

CDN は、世界中のエッジ・サーバー上に Web コンテンツをキャッシュすることで、その目的を果たします。カスタマーが Web コンテンツを要求すると、そのカスタマーに地理的に最も近いエッジ・サーバーに、コンテンツ要求がルーティングされます。CDN では、コンテンツの必要移動距離を削減することで、スループットの最適化、最小限の遅延、パフォーマンスの向上が実現されます。コンテンツ・プロバイダーは、IBM Cloud Content Delivery Network with Akamai を使用して、世界中から要求されたコンテンツを最小限の構成で有効に配信することができます。

IBM Cloud Content Delivery Network サービスの主要機能は、以下のとおりです。
  * ホスト・サーバー・オリジンのサポート
  * オブジェクト・ストレージ・オリジンのサポート
  * 明確なパスを使用した複数オリジンのサポート
  * パスベースの CDN マッピング
  * キャッシュ・コンテンツのパージ
  * 存続時間 (TTL)
  * グラフィカル・ビューを使用したメトリック
  * ワイルドカード証明書による HTTPS のサポート
  * ホスト・ヘッダーのサポート
  * 失効コンテンツの提供
  * 「キャッシュ・キーの照会引数を無視する」機能
  * コンテンツ圧縮
  * ラージ・ファイルの最適化
  * ビデオ・オンデマンド

## 機能の説明

### ホスト・サーバー・オリジンのサポート

IBM Cloud Content Delivery Network (CDN) は、オリジンのホスト名、プロトコル、ポート番号、およびオプションでコンテンツの提供元のパスを指定することにより、ホスト・サーバー・オリジンからコンテンツを提供するように構成することができます。デフォルトのパスは「/\*」です。プロトコルは HTTP、HTTPS、またはその両方の場合があります。Akamai がサポートするのは特定のポート番号のみです。サポート対象のポート番号と範囲については、[FAQ](faqs.html#are-there-any-restrictions-on-what-http-and-https-port-numbers-are-allowed-for-akamai-) を参照してください。現在、ワイルドカード証明書を使用して HTTPS がサポートされています。つまりこのサービスは、`.cdnedge.bluemix.net` で終わる CNAME によってのみアクセス可能になります。詳しくは、[ワイルドカード証明書を使用した HTTPS](about.html#https-with-wildcard-certificate-) 機能の説明を参照してください。

### オブジェクト・ストレージ・オリジンのサポート

IBM Cloud CDN は、_エンドポイント_、_バケット名_、_プロトコル_、および_ポート_を提供することで、オブジェクト・ストレージ・エンドポイントからのコンテンツを提供するように構成することができます。オプションで、ファイル拡張子のリストを、その拡張子を持つファイルのキャッシングのみを許可するように指定することができます。バケット内のすべてのオブジェクトに、匿名読み取り権限または公開読み取り権限を設定する必要があります。[IBM Bluemix Object Storage with CDN のセットアップ方法 (How to set up IBM Bluemix Object Storage with CDN)](https://console.bluemix.net/docs/tutorials/static-files-cdn.html#accelerate-delivery-of-static-files-using-a-cdn) にあるチュートリアルで、詳細情報を提供しています。

### 明確なパスを使用した複数オリジンのサポート

異なるオリジン・サーバーから特定のコンテンツを配信することができる場合があります。例えば、異なるオリジン・サーバーから提供される特定の写真やビデオが必要だとします。IBM Cloud CDN は、複数のパスを使用した複数のオリジン・サーバーをセットアップするオプションを提供します。これにより、データの保管方法と保管場所が柔軟に決定できます。オリジン・サーバー用のパスは、CDN について固有でなければなりません。オリジン・サーバー自体は、固有である必要はありません。

### パスベースの CDN マッピング

IBM Cloud CDN の作成時にオリジン・サーバーのディレクトリー・パスを提供することで、IBM Cloud CDN サービスを特定のディレクトリー・パスに制限することができます。エンド・ユーザーは、そのディレクトリー・パス内のコンテンツにのみアクセスすることが許可されます。例えば CDN www.example.com がパス「/videos」で作成されている場合、`www.example.com/videos/` によってのみアクセスすることができます

### キャッシュ・コンテンツのパージ

IBM Cloud CDN は、キャッシュに入れられたコンテンツをエッジ・サーバーから便利に素早く削除 (パージ) する機能を提供します。この時、パージはファイル・パスに対してのみ許可されます。現行では、Purge implementation with Akamai により、約 5 秒でファイルがパージされます。この UI では、パージの履歴を表示することもでき、特定のパージ・パスをお気に入りとしてタグ付けすることもできます。

### 存続時間 (TTL)

存続時間は、エッジ・サーバーが特定のファイルまたはディレクトリー・パスのコンテンツをキャッシュに入れる時間 (秒単位) を示します。CDN が最初に作成されると、3600 秒のデフォルト時間でパス (/\*) についての全体の存続時間 (TTL) が作成されます。TTL の最小値は 30 秒で、最大値は 2147483647 秒です。各項目に対して、TTL パスは CDN ごとに固有でなければなりません。複数のパスが特定のコンテンツに一致する場合は、最後に構成されたパスのマッチングがそのコンテンツに適用されます。例えば、存続時間値 3000 秒で最初に作成された `/example/file` と、存続時間値 4000 秒で後から作成された `/example/*` という 2 つの TTL を検討します。`/example/file` のほうがより特定的ですが、`/example/*` のほうが後から作成されたので、`/example/file` の TTL は 4000 秒になります。TTL エントリーは、作成後、パスと時間 (あるいはどちらか) を編集することができます。パスと時間は削除することもできます。

### グラフィカル・ビューを使用したメトリック

各 CDN のメトリックは、その CDN マッピングのカスタマー・ポータルにある「概要」タブに表示されます。2 つのタイプのメトリックが CDN の使用量から計算されます。ある期間に渡るメトリックをグラフで表示したものと、集合値で表示したものです。

ある期間にわたる変化をグラフ表示したメトリックは、3 つの折れ線グラフと 1 つの円グラフで確認することができます。3 つの折れ線グラフは、**帯域幅**、**マッピング別のヒット**、および**タイプ別のヒット**です。3 つのグラフは、指定した時間フレームにわたる毎日の活動を表示します。**帯域幅**と**マッピング別のヒット**のグラフは単線グラフですが、**タイプ別のヒット**の詳細は、提供されるヒット・タイプごとに 1 つの線を示しています。円グラフは、CDN マッピングについて帯域幅の地域別の詳細を百分率で示しています。

集合値のメトリックには、**帯域幅使用量** (GB)、CDN エッジ・サーバーに対する**総ヒット数**、および**ヒット率**が含まれます。ヒット率は、コンテンツがオリジンを介してではなくエッジ・サーバーによって配信された割合 (パーセンテージ) を示しています。現行のヒット率は、表示中の 1 つの CDN マッピングではなく、すべての CDN マッピングの関数として表示されます。

デフォルトでは、集合数とグラフの両方で最後の 30 日間分のメトリックが表示されますが、[カスタマー・ポータル![外部リンク・アイコン](../../icons/launch-glyph.svg " 外部リンク・アイコン")](https://control.softlayer.com/)で変更することができます。両方のカテゴリーで、7 日、15 日、30 日、60 日、または 90 日間のメトリックを表示することができます。

### ワイルドカード証明書による HTTPS のサポート

ワイルドカード証明書は、Web コンテンツをエンド・ユーザーに安全に届けるための最も効率的な手段です。 この機能は、CDN またはオリジン・パスを構成するときに `HTTPS ポート`を選択することで使用可能になります。ワイルドカード証明書を使用して CDN マッピングを HTTPS 対応にすると、エッジ・サーバーは HTTPS を介してオリジン・サーバーと連絡を取ります。オリジン・サーバーがホスト名として指定されている場合、デフォルトでは、エッジ・サーバーはオリジン・サーバーとの Transport Layer Security (TLS) ネゴシエーションの Server Name Indication (SNI) ヘッダーとして、オリジン・ホスト名を使用します。ただし、オリジン・サーバーが IP アドレスとして指定されている場合は、CDN のホスト名が SNI ヘッダーとして使用されます。オリジン証明書は、承認された認証局 (CA) による署名が必要です。

ワイルドカード証明書が使用されている場合は、エンド・ユーザー**のみ**に CNAME を使用したサービスへのアクセス権限があります。例えば、ドメインが `example.com` で、CNAME が `example.cdnedge.bluemix.net` の場合、ご使用の CDN サービスは `https://example.cdnedge.bluemix.net` を介して**のみ**アクセス可能です。ワイルドカード証明書を指定した HTTPS 使用時の影響については、[FAQ](faqs.html#what-should-be-the-expected-behavior-when-loading-the-cname-or-hostname-on-your-browser-for-the-supported-cdn-protocols-) を参照してください。

業界のベスト・プラクティスとして、信頼されている一連の中間証明書は頻繁に変更するため、Akamai は中間証明書ではなくルート証明書のみを信頼しています。セキュリティー上の理由から、Akamai は そのトラストストアにルート認証局のみを含めています。そのため、オリジンはリーフ証明書とすべての中間証明書 (ルート証明書を含まない) を含むすべての証明書チェーンを、エッジ・サーバーとの SSL ハンドシェークの一部として送信する必要があります。Akamai の信頼証明書は [こちら](https://community.akamai.com/docs/DOC-4447-ssltls-certificate-chains-for-akamai-managed-certificates)で検索することができます。

### ホスト・ヘッダーのサポート

エッジ・サーバーは、オリジン・ホストと通信するときにホスト・ヘッダーを使用します。この機能により、オリジン・ホストで Web サービスが構成される方法が柔軟になります。ホスト・ヘッダーの入力データが指定されない場合で、オリジン・サーバーがホスト名 (IP アドレスではなく) として指定されると、サービスはデフォルトの HTTP ホスト・ヘッダーとしてオリジン・サーバー・ホスト名を使用します。ホスト・ヘッダーが入力として指定されず、かつオリジン・サーバーが IP アドレスとして指定される場合は、CDN ホスト名 (CDN ドメイン・ネームとも呼ばれる) がデフォルトの HTTP ホスト・ヘッダーとして使用されます。

### ヘッダーを尊重 (Respect Headers)

「ヘッダーを尊重 (Respect Headers)」オプションにより、オリジンの HTTP ヘッダー構成で CDN 構成をオーバーライドできます。この機能はデフォルトではオンですが、オフにすることもできます。

### 失効コンテンツの提供

CDN エッジ・サーバーがユーザー要求を受け取り、要求コンテンツがキャッシュに入っていない場合、エッジ・サーバーはコンテンツを取り出すためにオリジン・ホストに到達します。コンテンツはその後、コンテンツに指定された存続時間 (TTL) の間、キャッシュに入ります。TTL の有効期限が切れた後にユーザー要求が受け取られると、エッジ・サーバーはコンテンツを取り出すためにオリジン・ホストに到達します。何らかの理由でオリジン・サーバーに到達できない場合 (オリジン・ホストがダウンしている、ネットワークの問題がある、など) は、エッジ・サーバーは期限切れの (失効した) コンテンツを要求に送信します。この機能は Akamai によってサポートされており、オフにすることは**できません**。

### 「キャッシュ・キーの照会引数を無視する」機能

Akamai エッジ・サーバーは、「キャッシュ・ストア」と呼ばれる場所にキャッシュ・コンテンツを保管します。「キャッシュ・ストア」からのコンテンツを使用するには、エッジ・サーバーは「キャッシュ・キー」を使用します。通常、キャッシュ・キーはエンド・ユーザーの URL 部分に基づいて生成されます。URL には、ユーザーごとに異なる照会関数引数が含まれている場合もありますが、配信されるコンテンツは同じです。デフォルトでは、Akamai は照会関数の引数を使用してキャッシュ・キーを生成するため、結果として各ユーザーに固有のキャッシュ・キーを生成します。このメソッドは最適ではありません。このメソッドでは、すでにキャッシュに入っていて異なるキャッシュ・キーを使用するコンテンツのために、エッジ・サーバーがオリジン・サーバーに接続することになるからです。**キャッシュ・キーの照会引数を無視する**機能により、キャッシュ・キーの生成時に照会引数を無視するかどうかを指定することができます。この機能は、オリジン・パスの`作成`または`更新`と同様に、CDN マッピング構成の`作成`または`更新`に適用されます。

**注:** キャッシュ・キーの照会引数は、CDN マッピングの作成後に「設定」タブから構成することができます。オリジン・パスについては、オリジン・パスの`作成`または`更新`時に、照会引数を構成することができます。

### コンテンツ圧縮

コンテンツ圧縮は、Akamai CDN で以下のコンテンツ・タイプについてデフォルトで使用可能です。
* text/html*
* text/css*
* text/xml*
* text/json
* text/javascript*
* text/plain*
* application/x-javascript*
* application/json
* application/xml*

圧縮がエッジ・サーバーによって処理される場合、コンテンツは少なくとも 10 KB である必要があります。圧縮がオリジン・サーバーで処理される場合もあり、その場合、圧縮されるファイルのサイズに制限はありません。オリジン・サーバーによってコンテンツがすでに圧縮されている場合は、再度圧縮されることはありません。コンテンツ圧縮を使用可能にするには、要求ヘッダーが `Accept-Encoding: gzip` を定義する必要があります。

### ラージ・ファイルの最適化

ラージ・ファイルの最適化により、CDN ネットワークは 10 MB より大きいコンテンツの配信を最適化することができます。これにより、ラージ・ファイルのパフォーマンスが向上し、待ち時間とダウンロード時間が削減されます。この機能を使用しないと、CDN は 1.8 GB より大きいサイズのファイルを提供することができません。この機能により、1.8 GB より大きいファイルのダウンロードが最大 320 GB まで可能になります。

ラージ・ファイルの最適化を機能させるには、オリジン・サーバーでバイト範囲の要求を使用可能にする**必要があります**。Akamai CDN は、この最適化に部分オブジェクト・キャッシングと呼ばれる技術を採用しています。ラージ・ファイルが要求されると、エッジ・サーバーは、ファイルがサイズ要件に見合っているかどうかを確認します。これは、10 MB より大きいファイルは、オリジン・サーバーからチャンクで要求されることを意味します。チャンクがエッジ・サーバーに到着すると、キャッシュに入れられてすぐにユーザーに配信されます。次のチャンクは、エッジ・サーバーによって平行してプリフェッチされるため、待ち時間が削減されます。このプロセスは、ファイル全体が取得されるまで、または接続が終了するまで続きます。  

この機能が使用可能になると、10 MB より小さいコンテンツのサービス提供に関連したパフォーマンス・コストがわずかに発生します。そのため、この機能はラージ・ファイルのサービス提供をする場合にのみ推奨します。CDN 構成で新規のオリジン・パスを作成し、そのパスのラージ・ファイルの最適化を有効にするのが典型的なユース・ケースです。

### ビデオ・オンデマンド

**ビデオ・オンデマンド**のパフォーマンス最適化は、多様なネットワーク・タイプにわたり高品質のストリーミングを配信します。負荷を動的に分散する分散ネットワークの機能を使用することで、IBM Cloud CDN with Akamai では、計画の有無にかかわらず、大規模なオーディエンスに対応した急激な拡大が可能です。

**ビデオ・オンデマンド**は、HLS、DASH、HDS、HSS などのセグメント化されたストリーミング形式の分散に対して最適化されます。ライブ・ビデオ・ストリーミングは、この時点ではサポートされて**いません**。「設定」タブの**「最適化 (Optimize for)」**にあるドロップダウン・メニューでオプションを選択するか、新規のオリジン・パスの作成時に、**ビデオ・オンデマンド**機能を有効にできます。この機能は、ビデオ・ファイルの配信を最適化する場合にのみ有効にします。
